<!DOCTYPE html>
<html>
  <head>
    <!-- CallerID.com 2020 -->
    <title>ELConfig 5m</title>
    <link rel="stylesheet" type="text/css" href="frmMain.css">
    <link rel="stylesheet" type="text/css" href="./plugins/jquery-ui.css">
    <link rel="stylesheet" type="text/css" href="./plugins/jquery-ui.structure.min.css">
    <link rel="stylesheet" type="text/css" href="./plugins/jquery-ui.theme.min.css">

    <!-- Include jQuery -->
    <script>
        window.$ = window.jQuery = require("jquery");
    </script>
    <script src="./plugins/jquery-ui.js"></script>
    <!-------------------->
    <!-- UDP Code -------->
    <script src="./udp.js" type="text/javascript"></script>
    <!-------------------->
    <script>

        var gv_phone_data = [];
        function write_to_phone(ln, io, se, dur, cs, rings, date, time, num, name, clear_as_bool)
        {
            if(clear_as_bool)
            {
                gv_phone_data = [];
            }
            else
            {
                var template_text = `
                <table id="gv_phone_row_id_xxx" class="grid_row_phone">
                    <tr>
                    <td style="width:54px;">Ln</td>
                    <td style="width:63px;">IO</td>
                    <td style="width:60px;">SE</td>
                    <td style="width:77px;">Dur</td>
                    <td style="width:61px;">CS</td>
                    <td style="width:64px;">Rings</td>
                    <td style="width:48px;">Date</td>
                    <td style="width:98px;">Time</td>
                    <td style="text-align:center;width: 192px;">Number</td>
                    <td style="text-align:center;border-right:none;width: 205px;">Name</td>
                    </tr>
                </table>
                `;

                template_text = template_text.replace("Ln", ln);
                template_text = template_text.replace("IO", io);
                template_text = template_text.replace("SE", se);
                template_text = template_text.replace("Dur", dur);
                template_text = template_text.replace("CS", cs);
                template_text = template_text.replace("Rings", rings);
                template_text = template_text.replace("Date", date);
                template_text = template_text.replace("Time", time);
                template_text = template_text.replace("Number", num);
                template_text = template_text.replace("Name", name);

                gv_phone_data.push(template_text);
            }

            update_phone_data();
        }

        function update_phone_data()
        {
            var all_rows = "";
            var cnt = 1;
            gv_phone_data.forEach(function(row){
                all_rows += row.replace("gv_phone_row_id_xxx", "gv_phone_row_id_" + cnt);
                cnt++;
            });

            $("#gv_phone_data").html(all_rows);

            cnt--;
            var rowpos = $('#gv_phone_row_id_' + cnt).position();
            $('#gv_phone_data').scrollTop(rowpos.top);

        }

        var gv_comm_data = [];
        function write_to_comm(str, clear_as_bool)
        {
            if(clear_as_bool)
            {
                gv_comm_data = [];
                last_v_command_reception = "";
            }
            else
            {
                var row = "<tr><td>" + str + "</td></tr>";
                gv_comm_data.push(row);
            }
            update_comm_data();
        }

        function update_comm_data()
        {
            var all_rows = "";

            gv_comm_data.forEach(function(row){
                all_rows += row;
            });

            $("#gv_comm_data").html(all_rows);

            var rowpos = $('#table_comm tr:last').position();
            $('#gv_comm_data').scrollTop(rowpos.top);
        }

        // --------------------------------------------------
        //                 Popups/Windows
        // --------------------------------------------------
        var pWin_computer_info = null;
        var pWin_duplicates = null;
        var pWin_line_count = null;
        var pWin_ping = null;
        var pWin_reseting_to_el_defaults = null;
        var pWin_setting_deluxe_output = null;
        var pWin_deluxe_to_basic = null;
        var pWin_time_change = null;

        function open_ping()
        {
            pWin_ping = $("#pWin_ping").dialog({
                    autoOpen: false,
                    width: 400,
                    height: 290,
                    show: {
                        effect: "blind",
                        duration: 400
                    },
                    hide: {
                        effect: "fade",
                        duration: 400
                    }
            });
            
            pWin_ping.dialog('open');
            $("#pWin_ping_1").focus();
            $("#pWin_ping_1").select();
        }

        function open_line_count()
        {
            pWin_line_count = $("#pWin_line_count").dialog({
                    autoOpen: false,
                    width: 235,
                    height: 170,
                    show: {
                        effect: "blind",
                        duration: 400
                    },
                    hide: {
                        effect: "fade",
                        duration: 400
                    }
            });

            pWin_line_count.dialog('open');
        }

        function open_duplicates()
        {
            if(firmware_version == "Unknown" && dup_locked)
            {
                alert("Firmware not supported for this action. Contact CallerID.com.");
                return;
            }

            pWin_duplicates = $("#pWin_duplicates").dialog({
                    autoOpen: false,
                    width: 400,
                    height: 330,
                    show: {
                        effect: "blind",
                        duration: 400
                    },
                    hide: {
                        effect: "fade",
                        duration: 400
                    }
            });

            pWin_duplicates.dialog('open');  
        }
        function open_computer_info()
        {
            pWin_computer_info = $("#pWin_computer_info").dialog({
                    autoOpen: false,
                    width: 500,
                    height: 180,
                    show: {
                        effect: "blind",
                        duration: 400
                    },
                    hide: {
                        effect: "fade",
                        duration: 400
                    }
            });

            pWin_computer_info.dialog('open');
        }

        function open_resetting_el_defaults()
        {
            pWin_reseting_to_el_defaults = $("#pWin_reseting_to_el_defaults").dialog({
                    autoOpen: false,
                    width: 400,
                    height: 180,
                    show: {
                        effect: "blind",
                        duration: 400
                    },
                    hide: {
                        effect: "fade",
                        duration: 400
                    }
            });

            pWin_reseting_to_el_defaults.dialog('open');
        }

        function open_setting_deluxe_output()
        {
            pWin_setting_deluxe_output = $("#pWin_setting_deluxe_output").dialog({
                    autoOpen: false,
                    width: 400,
                    height: 180,
                    show: {
                        effect: "blind",
                        duration: 400
                    },
                    hide: {
                        effect: "fade",
                        duration: 400
                    }
            });

            pWin_setting_deluxe_output.dialog('open');
        }

        function open_deluxe_to_basic()
        {
            pWin_deluxe_to_basic = $("#pWin_deluxe_to_basic").dialog({
                    autoOpen: false,
                    width: 400,
                    height: 180,
                    show: {
                        effect: "blind",
                        duration: 400
                    },
                    hide: {
                        effect: "fade",
                        duration: 400
                    }
            });

            pWin_deluxe_to_basic.dialog('open');
        }

        function alert_time_changed()
        {
            pWin_time_change = $("#pWin_time_change").dialog({
                    autoOpen: false,
                    width: 260,
                    height: 160,
                    show: {
                        effect: "blind",
                        duration: 400
                    },
                    hide: {
                        effect: "fade",
                        duration: 400
                    },
                    buttons: {
                        "OK": function() {
                            $( this ).dialog( "close" );
                        },
                    }
            });

            pWin_time_change.dialog('open');
        }

        // ------------------------------------------------------------
        var info_content_unit_ip = `
            Set a static IP address within the IP scheme either outside the DHCP range or a value that would not create an IP conflict with another device on the network.<br/><br/>Based on this computerâ€™s IP address of: [computer_ip] the suggested IP of the unit should be: [suggested_ip].
        `;
        $(document).ready(function(){

            $("#lbFirmwareVersion").mousedown(function(e){

                if(firmware_version != "Unknown") return;
                
                if(e.which == 3)
                {
                    dup_locked = !dup_locked;

                    if(dup_locked) 
                    {
                        alert("Setting of Duplicates is now unavailable.");
                    }
                    else
                    {
                        alert("Setting of Duplicates is now AVAILABLE.");
                    }
                }

            });

            $("#btnOpenResourceMon").on('click', function(){

                require("child_process").exec("resmon");
                $("#win_resmon_step_1").addClass("hidden");
                $("#win_resmon_step_2").removeClass("hidden");
                $("#win_resmon_step_3").addClass("hidden");
                set_resmon_1();

            });

            $("#win_resmon_step_2_back").on('click', function(){

                $("#win_resmon_step_1").removeClass("hidden");
                $("#win_resmon_step_2").addClass("hidden");
                $("#win_resmon_step_3").addClass("hidden");

            });

            $("#win_resmon_step_2_next").on('click', function(){

                $("#win_resmon_step_1").addClass("hidden");
                $("#win_resmon_step_2").addClass("hidden");
                $("#win_resmon_step_3").removeClass("hidden");
                set_resmon_2();

            });

            $("#win_resmon_step_3_back").on('click', function(){

                $("#win_resmon_step_1").addClass("hidden");
                $("#win_resmon_step_2").removeClass("hidden");
                $("#win_resmon_step_3").addClass("hidden");
                set_resmon_1();

            });

            $("#btnKillTask").on('click', function(){

                var pid = $("#pid").val();
                var elc_pid = process.pid.toString();

                if(pid == elc_pid) return;

                process.kill(pid);
                
                setTimeout(rebind, 1200);

            });

            $("#btnKillTaskMac").on('click', function(){

                var pid = $("#pid_mac").val();
                var elc_pid = process.pid.toString();

                if(pid == elc_pid) return;
                process.kill(pid);

                setTimeout(rebind, 1000);

            });

            function set_resmon_1() {
                $('#resmon_fades').fadeIn(750).html('<img style="float:right;padding-top:10px;padding-right:40px;" src="./resmon_1.png" />');
            }

            function set_resmon_2() {
                $('#resmon_fades').fadeIn(750).html('<img style="float:right;padding-top:10px;padding-right:40px;" src="./resmon_2.png" />');
            }

            $( function() {
                $( "#pWin_reseting_to_el_defaults_progressbar" ).progressbar({
                    value: 4
                    });
            });

            $( function() {
                $( "#pWin_deluxe_output_progressbar" ).progressbar({
                    value: 1
                    });
            });

            $( function() {
                $( "#pWin_deluxe_to_basic_progressbar" ).progressbar({
                    value: 1
                    });
            });

            // Clear comm data
            write_to_comm("", true);

            // Populate computer info
            handle_computer_info();

            // --------------------------------------------------------
            // Check bound status
            // Update status below
            var dialog_bind_warning_3520 = $("#bind_warning_3520").dialog({
                    autoOpen: false,
                    show: {
                        effect: "blind",
                        duration: 500
                    },
                    hide: {
                        effect: "fade",
                        duration: 500
                    },
                    buttons: {
                        "Close": function() {
                        $( this ).dialog( "close" );
                        }
                    }
            });

            var dialog_bind_warning_6699 = $("#bind_warning_6699").dialog({
                    autoOpen: false,
                    show: {
                        effect: "blind",
                        duration: 500
                    },
                    hide: {
                        effect: "fade",
                        duration: 500
                    },
                    buttons: {
                        "Close": function() {
                        $( this ).dialog( "close" );
                        }
                    }
            });

            var dialog_bind_warning_3520_6699 = $("#bind_warning_3520_6699").dialog({
                    autoOpen: false,
                    show: {
                        effect: "blind",
                        duration: 500
                    },
                    hide: {
                        effect: "fade",
                        duration: 500
                    },
                    buttons: {
                        "Close": function() {
                        $( this ).dialog( "close" );
                        }
                    }
            });

            // --------------------------------------------------
            if(get_bound_status(3520) && get_bound_status(6699))
            {
                $('#lbBoundTo').text("Bound: 3520 & 6699");
            }
            else if(!get_bound_status(3520) && get_bound_status(6699))
            {
                $('#lbBoundTo').text("Bound: 6699");
                //dialog_bind_warning_3520.dialog('open');
            }
            else if(get_bound_status(3520) && !get_bound_status(6699))
            {
                $('#lbBoundTo').text("Bound: 3520");
                //dialog_bind_warning_6699.dialog('open');
            }
            else
            {
                $('#lbBoundTo').text("Bound: Failed");
                //dialog_bind_warning_3520_6699.dialog('open');
            }

            // --------------------------------------------------------

            let info_content_main = `
                This configuration and test tool is normally for:<br/>
                <ul>
                    <li>Setting the static IP of the device</li>
                    <li>Testing for call records arriving from the Caller ID unit</li>
                </ul>
                Advanced users can set a number of other parameters including:<br/>
                <ul>
                    <li>Toggles for output options on Deluxe units</li>
                    <li>Destination IP and MAC unicasts</li>
                    <li>Duplicate call record delivery to increase throughput</li>
                    <li>Starting Line count when connecting multiple units</li>
                </ul>
            `;

            let info_content_unit_number = `
                Some applications use unit numbers to match data arriving from multiple units.
            `;

            let info_content_dest_port = `
                The default Network communication port is 3520. Do not change unless your application absolutely requires it. A value other than 3520 or 6699 will require you change the listening port on this application.
            `;

            let info_content_dest_ip = `
                The IP to where the call records will be sent. The default is 255.255.255.255 (broadcast) which most applications use, even if only one PC is listening for data. Change only if necessary.
            `;

            let info_content_dest_mac = `
                The MAC address to where call records will be sent. The default is FF-FF-FF-FF-FF-FF (Broadcast) which most applications use. Change to specific MAC only if the Destination IP is specified as a unicast.
            `;

            $('#lbInfoTitle').text('ELConfig:');
            $('#lbInfoContent').html(info_content_main);

            $('#btnChangeUnitNumber').hover(
                
                // Hover
                function(){
                    $('#lbInfoTitle').text('Unit Number:');
                    $('#lbInfoContent').html(info_content_unit_number);
                },

                // Exit
                function(){
                    $('#lbInfoTitle').text('ELConfig:');
                    $('#lbInfoContent').html(info_content_main);
             });

            $('#btnChangeUnitNumber').on('click', function(){

                var btn_text = $('#btnChangeUnitNumber').text();

                if(btn_text == "Change")
                {
                    editing_unit_number = true;
                    document.getElementById("tbUnitNumber").disabled = false;
                    $('#btnChangeUnitNumber').addClass("highlight");
                    $('#tbUnitNumber').addClass("highlight");
                    $('#btnChangeUnitNumber').text("Save");
                }
                else
                {
                    // Save
                    var new_unit_number = $('#tbUnitNumber').val();
                    set_unit_number(new_unit_number);

                    // Reset
                    editing_unit_number = false;
                    document.getElementById("tbUnitNumber").disabled = true;
                    $('#btnChangeUnitNumber').removeClass("highlight");
                    $('#tbUnitNumber').removeClass("highlight");
                    $('#btnChangeUnitNumber').text("Change");
                }

            });

            $('#btnSuggestIP').hover(
            
                // Hover
                function(){
                    $('#lbInfoTitle').text('Unit IP Address:');
                    $('#lbInfoContent').html(info_content_unit_ip);
                },

                // Exit
                function(){
                    $('#lbInfoTitle').text('ELConfig:');
                    $('#lbInfoContent').html(info_content_main);
            });

            $('#btnSuggestIP').on('click', function(){

                var btn_text = $('#btnSuggestIP').text();

                if(btn_text == "Set to Suggested IP")
                {
                    editing_unit_ip = true;

                    $('#tbUnitIP_1').val(pc_suggested_ip_parts[0]);
                    $('#tbUnitIP_2').val(pc_suggested_ip_parts[1]);
                    $('#tbUnitIP_3').val(pc_suggested_ip_parts[2]);
                    $('#tbUnitIP_4').val(pc_suggested_ip_parts[3]);

                    document.getElementById("tbUnitIP").setAttribute("disabled", false);
                    document.getElementById("tbUnitIP_1").disabled = false;
                    document.getElementById("tbUnitIP_2").disabled = false;
                    document.getElementById("tbUnitIP_3").disabled = false;
                    document.getElementById("tbUnitIP_4").disabled = false;

                    $('#btnSuggestIP').addClass("highlight");

                    $('#tbUnitIP').addClass("highlight");
                    $('#tbUnitIP_1').addClass("highlight");
                    $('#tbUnitIP_2').addClass("highlight");
                    $('#tbUnitIP_3').addClass("highlight");
                    $('#tbUnitIP_4').addClass("highlight");

                    $('#btnSuggestIP').text("Save");
                    $('#tbUnitIP_1').focus();
                    $('#tbUnitIP_1').select();

                }
                else
                {
                    // Save
                    var new_unit_ip = $('#tbUnitIP_1').val();
                    new_unit_ip += "." + $('#tbUnitIP_2').val();
                    new_unit_ip += "." + $('#tbUnitIP_3').val();
                    new_unit_ip += "." + $('#tbUnitIP_4').val();
                    
                    set_unit_ip(new_unit_ip);

                    // Reset
                    editing_unit_ip = false;

                    document.getElementById("tbUnitIP").setAttribute("disabled", true);
                    document.getElementById("tbUnitIP_1").disabled = true;
                    document.getElementById("tbUnitIP_2").disabled = true;
                    document.getElementById("tbUnitIP_3").disabled = true;
                    document.getElementById("tbUnitIP_4").disabled = true;

                    $('#btnSuggestIP').removeClass("highlight");

                    $('#tbUnitIP').removeClass("highlight");
                    $('#tbUnitIP_1').removeClass("highlight");
                    $('#tbUnitIP_2').removeClass("highlight");
                    $('#tbUnitIP_3').removeClass("highlight");
                    $('#tbUnitIP_4').removeClass("highlight");

                    $('#btnSuggestIP').text("Set to Suggested IP");
                }

            });

            $('#tbUnitIP_1').on('keyup', function(event){

                var key = event.keyCode;
                var text = $('#tbUnitIP_1').val();

                var int_value = parseInt(text);
                if(int_value > 255)
                {
                    $('#tbUnitIP_1').val(text.substr(0, text.length - 1));
                    return;
                }

                if(key == 190 || key == 110) // periods
                {
                    $('#tbUnitIP_1').val(text.substr(0, text.length - 1));
                    $('#tbUnitIP_2').focus();
                    $('#tbUnitIP_2').select();
                    return;
                }

                var is_valid = /^(48|49|50|51|52|53|54|55|56|57|96|97|98|99|100|101|102|103|104|105)$/.test("" + key);

                if(key != 8 && text.length == 3 && is_valid) 
                {
                    $('#tbUnitIP_2').focus();
                    $('#tbUnitIP_2').select();
                }

            });

            $('#tbUnitIP_1').on('keydown', function(event){

                var key = event.keyCode;

                var is_valid = /^(8|9|48|49|50|51|52|53|54|55|56|57|190|110|96|97|98|99|100|101|102|103|104|105)$/.test("" + key);
                if (!is_valid) {
                    return false;
                }

            });

            $('#tbUnitIP_2').on('keyup', function(event){

                var key = event.keyCode;
                var text = $('#tbUnitIP_2').val();

                var int_value = parseInt(text);
                if(int_value > 255)
                {
                    $('#tbUnitIP_2').val(text.substr(0, text.length - 1));
                    return;
                }

                if(key == 190 || key == 110) // periods
                {
                    $('#tbUnitIP_2').val(text.substr(0, text.length - 1));
                    $('#tbUnitIP_3').focus();
                    $('#tbUnitIP_3').select();
                    return;
                }
                
                var is_valid = /^(48|49|50|51|52|53|54|55|56|57|96|97|98|99|100|101|102|103|104|105)$/.test("" + key);

                if(key != 8 && text.length == 3 && is_valid) 
                {
                    $('#tbUnitIP_3').focus();
                    $('#tbUnitIP_3').select();
                }

            });

            $('#tbUnitIP_2').on('keydown', function(event){

                var key = event.keyCode;

                var is_valid = /^(8|9|48|49|50|51|52|53|54|55|56|57|190|110|96|97|98|99|100|101|102|103|104|105)$/.test("" + key);
                if (!is_valid) {
                    return false;
                }

            });

            $('#tbUnitIP_3').on('keyup', function(event){

                var key = event.keyCode;
                var text = $('#tbUnitIP_3').val();

                var int_value = parseInt(text);
                if(int_value > 255)
                {
                    $('#tbUnitIP_3').val(text.substr(0, text.length - 1));
                    return;
                }

                if(key == 190 || key == 110) // periods
                {
                    $('#tbUnitIP_3').val(text.substr(0, text.length - 1));
                    $('#tbUnitIP_4').focus();
                    $('#tbUnitIP_4').select();
                    return;
                }
                
                var is_valid = /^(48|49|50|51|52|53|54|55|56|57|96|97|98|99|100|101|102|103|104|105)$/.test("" + key);

                if(key != 8 && text.length == 3 && is_valid) 
                {
                    $('#tbUnitIP_4').focus();
                    $('#tbUnitIP_4').select();
                }

            });

            $('#tbUnitIP_3').on('keydown', function(event){

                var key = event.keyCode;

                var is_valid = /^(8|9|48|49|50|51|52|53|54|55|56|57|190|110|96|97|98|99|100|101|102|103|104|105)$/.test("" + key);
                if (!is_valid) {
                    return false;
                }

            });

            $("#tbUnitIP_4").on('keyup', function(event){

                var text = $('#tbUnitIP_4').val();

                var int_value = parseInt(text);
                if(int_value > 255)
                {
                    $('#tbUnitIP_4').val(text.substr(0, text.length - 1));
                    return;
                }

            });

            $('#tbUnitIP_4').on('keydown', function(event){

                var key = event.keyCode;

                var is_valid = /^(8|9|48|49|50|51|52|53|54|55|56|57|190|110|96|97|98|99|100|101|102|103|104|105)$/.test("" + key);
                if (!is_valid) {
                    return false;
                }

            });

            $('#btnChangeDestPort').hover(
                
                // Hover
                function(){
                    $('#lbInfoTitle').text('Unit Destination Port:');
                    $('#lbInfoContent').html(info_content_dest_port);
                },

                // Exit
                function(){
                    $('#lbInfoTitle').text('ELConfig:');
                    $('#lbInfoContent').html(info_content_main);
            });

            $('#btnChangeDestPort').on('click', function(){

                var btn_text = $('#btnChangeDestPort').text();

                if(btn_text == "Change")
                {
                    editing_dest_port = true;

                    $('#btnChangeDestPort').addClass("highlight");
                    document.getElementById("cbDestPort").removeAttribute("disabled", false);

                    $('#btnChangeDestPort').text("Save");

                }
                else
                {
                    editing_dest_port = false;

                    set_dest_port(document.getElementById("cbDestPort").value);

                    $('#btnChangeDestPort').removeClass("highlight");
                    document.getElementById("cbDestPort").setAttribute("disabled", true);

                    $('#btnChangeDestPort').text("Change");

                }

            });

            $('#btnChangeDestIP').hover(
                
                // Hover
                function(){
                    $('#lbInfoTitle').text('Destination IP Address:');
                    $('#lbInfoContent').html(info_content_dest_ip);
                },

                // Exit
                function(){
                    $('#lbInfoTitle').text('ELConfig:');
                    $('#lbInfoContent').html(info_content_main);
            });

            $('#btnChangeDestIP').on('click', function(){

                var btn_text = $('#btnChangeDestIP').text();

                if(btn_text == "Change")
                {
                    editing_dest_ip = true;

                    document.getElementById("tbDestIP").setAttribute("disabled", false);
                    document.getElementById("tbDestIP_1").disabled = false;
                    document.getElementById("tbDestIP_2").disabled = false;
                    document.getElementById("tbDestIP_3").disabled = false;
                    document.getElementById("tbDestIP_4").disabled = false;

                    $('#btnChangeDestIP').addClass("highlight");

                    $('#tbDestIP').addClass("highlight");
                    $('#tbDestIP_1').addClass("highlight");
                    $('#tbDestIP_2').addClass("highlight");
                    $('#tbDestIP_3').addClass("highlight");
                    $('#tbDestIP_4').addClass("highlight");

                    $('#btnChangeDestIP').text("Save");
                    $("#tbDestIP_1").focus();
                    $("#tbDestIP_1").select();
                    
                }
                else
                {
                    // Save
                    var new_unit_ip = $('#tbDestIP_1').val();
                    new_unit_ip += "." + $('#tbDestIP_2').val();
                    new_unit_ip += "." + $('#tbDestIP_3').val();
                    new_unit_ip += "." + $('#tbDestIP_4').val();
                    
                    set_dest_ip(new_unit_ip);

                    // Reset
                    editing_dest_ip = false;

                    document.getElementById("tbDestIP").setAttribute("disabled", true);
                    document.getElementById("tbDestIP_1").disabled = true;
                    document.getElementById("tbDestIP_2").disabled = true;
                    document.getElementById("tbDestIP_3").disabled = true;
                    document.getElementById("tbDestIP_4").disabled = true;

                    $('#btnChangeDestIP').removeClass("highlight");

                    $('#tbDestIP').removeClass("highlight");
                    $('#tbDestIP_1').removeClass("highlight");
                    $('#tbDestIP_2').removeClass("highlight");
                    $('#tbDestIP_3').removeClass("highlight");
                    $('#tbDestIP_4').removeClass("highlight");

                    $('#btnChangeDestIP').text("Change");
                }

            });

            $('#tbDestIP_1').on('keyup', function(event){

                var key = event.keyCode;
                var text = $('#tbDestIP_1').val();

                var int_value = parseInt(text);
                if(int_value > 255)
                {
                    $('#tbDestIP_1').val(text.substr(0, text.length - 1));
                    return;
                }

                if(key == 190 || key == 110) // periods
                {
                    $('#tbDestIP_1').val(text.substr(0, text.length - 1));
                    $('#tbDestIP_2').focus();
                    $('#tbDestIP_2').select();
                    return;
                }

                var is_valid = /^(48|49|50|51|52|53|54|55|56|57|96|97|98|99|100|101|102|103|104|105)$/.test("" + key);

                if(key != 8 && text.length == 3 && is_valid) 
                {
                    $('#tbDestIP_2').focus();
                    $('#tbDestIP_2').select();
                }

            });

            $('#tbDestIP_1').on('keydown', function(event){

                var key = event.keyCode;

                var is_valid = /^(8|9|48|49|50|51|52|53|54|55|56|57|190|110|96|97|98|99|100|101|102|103|104|105)$/.test("" + key);
                if (!is_valid) {
                    return false;
                }

            });

            $('#tbDestIP_2').on('keyup', function(event){

                var key = event.keyCode;
                var text = $('#tbDestIP_2').val();

                var int_value = parseInt(text);
                if(int_value > 255)
                {
                    $('#tbDestIP_2').val(text.substr(0, text.length - 1));
                    return;
                }

                if(key == 190 || key == 110) // periods
                {
                    $('#tbDestIP_2').val(text.substr(0, text.length - 1));
                    $('#tbDestIP_3').focus();
                    $('#tbDestIP_3').select();
                    return;
                }

                var is_valid = /^(48|49|50|51|52|53|54|55|56|57|96|97|98|99|100|101|102|103|104|105)$/.test("" + key);

                if(key != 8 && text.length == 3 && is_valid) 
                {
                    $('#tbDestIP_3').focus();
                    $('#tbDestIP_3').select();
                }

            });

            $('#tbDestIP_2').on('keydown', function(event){

                var key = event.keyCode;

                var is_valid = /^(8|9|48|49|50|51|52|53|54|55|56|57|190|110|96|97|98|99|100|101|102|103|104|105)$/.test("" + key);
                if (!is_valid) {
                    return false;
                }

            });

            $('#tbDestIP_3').on('keyup', function(event){

                var key = event.keyCode;
                var text = $('#tbDestIP_3').val();

                var int_value = parseInt(text);
                if(int_value > 255)
                {
                    $('#tbDestIP_3').val(text.substr(0, text.length - 1));
                    return;
                }

                if(key == 190 || key == 110) // periods
                {
                    $('#tbDestIP_3').val(text.substr(0, text.length - 1));
                    $('#tbDestIP_4').focus();
                    $('#tbDestIP_4').select();
                    return;
                }

                var is_valid = /^(48|49|50|51|52|53|54|55|56|57|96|97|98|99|100|101|102|103|104|105)$/.test("" + key);

                if(key != 8 && text.length == 3 && is_valid) 
                {
                    $('#tbDestIP_4').focus();
                    $('#tbDestIP_4').select();
                }

            });

            $('#tbDestIP_3').on('keydown', function(event){

                var key = event.keyCode;

                var is_valid = /^(8|9|48|49|50|51|52|53|54|55|56|57|190|110|96|97|98|99|100|101|102|103|104|105)$/.test("" + key);
                if (!is_valid) {
                    return false;
                }

            });

            $("#tbDestIP_4").on('keyup', function(event){

                var text = $('#tbDestIP_4').val();

                var int_value = parseInt(text);
                if(int_value > 255)
                {
                    $('#tbDestIP_4').val(text.substr(0, text.length - 1));
                    return;
                }

            });

            $('#tbDestIP_4').on('keydown', function(event){

                var key = event.keyCode;

                var is_valid = /^(8|9|48|49|50|51|52|53|54|55|56|57|190|110|96|97|98|99|100|101|102|103|104|105)$/.test("" + key);
                if (!is_valid) {
                    return false;
                }

            });

            $('#btnChangeDestMAC').hover(
                
                // Hover
                function(){
                    $('#lbInfoTitle').text('Unit MAC Address:');
                    $('#lbInfoContent').html(info_content_dest_mac);
                },

                // Exit
                function(){
                    $('#lbInfoTitle').text('ELConfig:');
                    $('#lbInfoContent').html(info_content_main);
            });

            $('#btnChangeDestMAC').on('click', function(){

                var btn_text = $('#btnChangeDestMAC').text();

                if(btn_text == "Change")
                {
                    editing_dest_mac = true;

                    document.getElementById("tbDestMAC").setAttribute("disabled", false);
                    document.getElementById("tbDestMAC_1").disabled = false;
                    document.getElementById("tbDestMAC_2").disabled = false;
                    document.getElementById("tbDestMAC_3").disabled = false;
                    document.getElementById("tbDestMAC_4").disabled = false;
                    document.getElementById("tbDestMAC_5").disabled = false;
                    document.getElementById("tbDestMAC_6").disabled = false;

                    $('#btnChangeDestMAC').addClass("highlight");

                    $('#tbDestMAC').addClass("highlight");
                    $('#tbDestMAC_1').addClass("highlight");
                    $('#tbDestMAC_2').addClass("highlight");
                    $('#tbDestMAC_3').addClass("highlight");
                    $('#tbDestMAC_4').addClass("highlight");
                    $('#tbDestMAC_5').addClass("highlight");
                    $('#tbDestMAC_6').addClass("highlight");

                    $('#btnChangeDestMAC').text("Save");

                    $("#tbDestMAC_1").focus();
                    $("#tbDestMAC_1").select();

                }
                else
                {

                    // Save
                    var new_dest_mac = "";
                    new_dest_mac += $('#tbDestMAC_1').val().padStart(2, "0").toUpperCase();
                    new_dest_mac += $('#tbDestMAC_2').val().padStart(2, "0").toUpperCase();
                    new_dest_mac += $('#tbDestMAC_3').val().padStart(2, "0").toUpperCase();
                    new_dest_mac += $('#tbDestMAC_4').val().padStart(2, "0").toUpperCase();
                    new_dest_mac += $('#tbDestMAC_5').val().padStart(2, "0").toUpperCase();
                    new_dest_mac += $('#tbDestMAC_6').val().padStart(2, "0").toUpperCase();

                    set_dest_mac(new_dest_mac);

                    // Reset
                    editing_dest_mac = false;

                    document.getElementById("tbDestMAC").setAttribute("disabled", true);
                    document.getElementById("tbDestMAC_1").disabled = true;
                    document.getElementById("tbDestMAC_2").disabled = true;
                    document.getElementById("tbDestMAC_3").disabled = true;
                    document.getElementById("tbDestMAC_4").disabled = true;
                    document.getElementById("tbDestMAC_5").disabled = true;
                    document.getElementById("tbDestMAC_6").disabled = true;

                    $('#btnChangeDestMAC').removeClass("highlight");

                    $('#tbDestMAC').removeClass("highlight");
                    $('#tbDestMAC_1').removeClass("highlight");
                    $('#tbDestMAC_2').removeClass("highlight");
                    $('#tbDestMAC_3').removeClass("highlight");
                    $('#tbDestMAC_4').removeClass("highlight");
                    $('#tbDestMAC_5').removeClass("highlight");
                    $('#tbDestMAC_6').removeClass("highlight");

                    $('#btnChangeDestMAC').text("Change");

                }

            });

            $("#tbDestMAC_1").on('keyup', function(event){

                var key = event.keyCode;
                var text = $('#tbDestMAC_1').val();

                var is_valid = /[0-9A-Fa-f]/.exec(key);

                if(key != 8 && text.length == 2 && is_valid != null) 
                {
                    $("#tbDestMAC_1").val($("#tbDestMAC_1").val().toUpperCase());
                    $('#tbDestMAC_2').focus();
                    $('#tbDestMAC_2').select();
                }

            });

            $("#tbDestMAC_1").on('keydown', function(event){

                var key = String.fromCharCode(event.keyCode);

                var is_valid = /[0-9A-Fa-f]/.exec(key);

                if(is_valid == null && event.keyCode != 8) return false;

            });

            $("#tbDestMAC_2").on('keyup', function(event){

                var key = event.keyCode;
                var text = $('#tbDestMAC_2').val();

                var is_valid = /[0-9A-Fa-f]/.exec(key);

                if(key != 8 && text.length == 2 && is_valid != null) 
                {
                    $("#tbDestMAC_2").val($("#tbDestMAC_2").val().toUpperCase());
                    $('#tbDestMAC_3').focus();
                    $('#tbDestMAC_3').select();
                }

            });

            $("#tbDestMAC_2").on('keydown', function(event){

                var key = String.fromCharCode(event.keyCode);

                var is_valid = /[0-9A-Fa-f]/.exec(key);

                if(is_valid == null && event.keyCode != 8) return false;

            });

            $("#tbDestMAC_3").on('keyup', function(event){

                var key = event.keyCode;
                var text = $('#tbDestMAC_3').val();

                var is_valid = /[0-9A-Fa-f]/.exec(key);

                if(key != 8 && text.length == 2 && is_valid != null) 
                {
                    $("#tbDestMAC_3").val($("#tbDestMAC_3").val().toUpperCase());
                    $('#tbDestMAC_4').focus();
                    $('#tbDestMAC_4').select();
                }

            });

            $("#tbDestMAC_3").on('keydown', function(event){

                var key = String.fromCharCode(event.keyCode);

                var is_valid = /[0-9A-Fa-f]/.exec(key);

                if(is_valid == null && event.keyCode != 8) return false;

            });

            $("#tbDestMAC_4").on('keyup', function(event){

                var key = event.keyCode;
                var text = $('#tbDestMAC_4').val();

                var is_valid = /[0-9A-Fa-f]/.exec(key);

                if(key != 8 && text.length == 2 && is_valid != null) 
                {
                    $("#tbDestMAC_4").val($("#tbDestMAC_4").val().toUpperCase());
                    $('#tbDestMAC_5').focus();
                    $('#tbDestMAC_5').select();
                }

            });

            $("#tbDestMAC_4").on('keydown', function(event){

                var key = String.fromCharCode(event.keyCode);

                var is_valid = /[0-9A-Fa-f]/.exec(key);

                if(is_valid == null && event.keyCode != 8) return false;

            });

            $("#tbDestMAC_5").on('keyup', function(event){

                var key = event.keyCode;
                var text = $('#tbDestMAC_5').val();

                var is_valid = /[0-9A-Fa-f]/.exec(key);

                if(key != 8 && text.length == 2 && is_valid != null) 
                {
                    $("#tbDestMAC_5").val($("#tbDestMAC_5").val().toUpperCase());
                    $('#tbDestMAC_6').focus();
                    $('#tbDestMAC_6').select();
                }

            });

            $("#tbDestMAC_5").on('keydown', function(event){

                var key = String.fromCharCode(event.keyCode);

                var is_valid = /[0-9A-Fa-f]/.exec(key);

                if(is_valid == null && event.keyCode != 8) return false;

            });

            $("#tbDestMAC_6").on('keydown', function(event){

                var key = String.fromCharCode(event.keyCode);

                var is_valid = /[0-9A-Fa-f]/.exec(key);

                if(is_valid == null && event.keyCode != 8) return false;

            });

            $("#pWin_ping_btnPing").on('click', function(){
                
                var ip = $("#pWin_ping_1").val() + ".";
                ip += $("#pWin_ping_2").val() + ".";
                ip += $("#pWin_ping_3").val() + ".";
                ip += $("#pWin_ping_4").val();

                ping_ip(ip);
            });

            $('#pWin_ping_1').on('keyup', function(event){

                var key = event.keyCode;
                var text = $('#pWin_ping_1').val();

                var int_value = parseInt(text);
                if(int_value > 255)
                {
                    $('#pWin_ping_1').val(text.substr(0, text.length - 1));
                    return;
                }

                if(key == 190 || key == 110) // periods
                {
                    $('#pWin_ping_1').val(text.substr(0, text.length - 1));
                    $('#pWin_ping_2').focus();
                    $('#pWin_ping_2').select();
                    return;
                }

                var is_valid = /^(48|49|50|51|52|53|54|55|56|57|96|97|98|99|100|101|102|103|104|105)$/.test("" + key);

                if(key != 8 && text.length == 3 && is_valid) 
                {
                    $('#pWin_ping_2').focus();
                    $('#pWin_ping_2').select();
                }

            });

            $('#pWin_ping_1').on('keydown', function(event){

                var key = event.keyCode;

                var is_valid = /^(8|9|48|49|50|51|52|53|54|55|56|57|190|110|96|97|98|99|100|101|102|103|104|105)$/.test("" + key);
                if (!is_valid) {
                    return false;
                }

            });

            $('#pWin_ping_2').on('keyup', function(event){

                var key = event.keyCode;
                var text = $('#pWin_ping_2').val();

                var int_value = parseInt(text);
                if(int_value > 255)
                {
                    $('#pWin_ping_2').val(text.substr(0, text.length - 1));
                    return;
                }

                if(key == 190 || key == 110) // periods
                {
                    $('#pWin_ping_2').val(text.substr(0, text.length - 1));
                    $('#pWin_ping_3').focus();
                    $('#pWin_ping_3').select();
                    return;
                }

                var is_valid = /^(48|49|50|51|52|53|54|55|56|57|96|97|98|99|100|101|102|103|104|105)$/.test("" + key);

                if(key != 8 && text.length == 3 && is_valid) 
                {
                    $('#pWin_ping_3').focus();
                    $('#pWin_ping_3').select();
                }

            });

            $('#pWin_ping_2').on('keydown', function(event){

                var key = event.keyCode;

                var is_valid = /^(8|9|48|49|50|51|52|53|54|55|56|57|190|110|96|97|98|99|100|101|102|103|104|105)$/.test("" + key);
                if (!is_valid) {
                    return false;
                }

            });

            $('#pWin_ping_3').on('keyup', function(event){

                var key = event.keyCode;
                var text = $('#pWin_ping_3').val();

                var int_value = parseInt(text);
                if(int_value > 255)
                {
                    $('#pWin_ping_3').val(text.substr(0, text.length - 1));
                    return;
                }

                if(key == 190 || key == 110) // periods
                {
                    $('#pWin_ping_3').val(text.substr(0, text.length - 1));
                    $('#pWin_ping_4').focus();
                    $('#pWin_ping_4').select();
                    return;
                }

                var is_valid = /^(48|49|50|51|52|53|54|55|56|57|96|97|98|99|100|101|102|103|104|105)$/.test("" + key);

                if(key != 8 && text.length == 3 && is_valid) 
                {
                    $('#pWin_ping_4').focus();
                    $('#pWin_ping_4').select();
                }

            });

            $('#pWin_ping_3').on('keydown', function(event){

                var key = event.keyCode;

                var is_valid = /^(8|9|48|49|50|51|52|53|54|55|56|57|190|110|96|97|98|99|100|101|102|103|104|105)$/.test("" + key);
                if (!is_valid) {
                    return false;
                }

            });

            $("#pWin_ping_4").on('keyup', function(event){

                var text = $('#pWin_ping_4').val();

                var int_value = parseInt(text);
                if(int_value > 255)
                {
                    $('#pWin_ping_4').val(text.substr(0, text.length - 1));
                    return;
                }

            });

            $('#pWin_ping_4').on('keydown', function(event){

                var key = event.keyCode;

                var is_valid = /^(8|9|48|49|50|51|52|53|54|55|56|57|190|110|96|97|98|99|100|101|102|103|104|105)$/.test("" + key);
                if (!is_valid) {
                    return false;
                }

            });

            // --------------------------------------------------------

            $('#btnGetToggles').on('click', function(){

                get_toggles();

            });

            $('#btnToggleC').on('click', function(){

                set_toggle($('#btnToggleC').val());

            });

            $('#btnToggleU').on('click', function(){

                set_toggle($('#btnToggleU').val());

            });

            $('#btnToggleD').on('click', function(){

                set_toggle($('#btnToggleD').val());

            });

            $('#btnToggleA').on('click', function(){

                set_toggle($('#btnToggleA').val());

            });

            $('#btnToggleS').on('click', function(){

                set_toggle($('#btnToggleS').val());

            });

            $('#btnToggleO').on('click', function(){

                set_toggle($('#btnToggleO').val());

            });

            $('#btnToggleB').on('click', function(){

                set_toggle($('#btnToggleB').val());

            });

            $('#btnToggleK').on('click', function(){

                set_toggle($('#btnToggleK').val());

            });

            $('#btnClearCommData').on('click', function(){

                write_to_comm("", true);

            });

            $('#btnClearPhoneData').on('click', function(){
                write_to_phone("", "", "", "", "", "", "", "", "", "", true);
            });

            // ----------- Popups/Windows -------------------
            $("#pWin_computer_info_btnClose").on('click', function(){
                pWin_computer_info.dialog('close');
            });

            $("#pWin_duplicates_btnSave").on('click', function(){
                
                var dups = $("#pWin_duplicates_dups").val();

                set_dups(dups.padStart(2, '0'));

            });

            $("#pWin_duplicates_btnCancel").on('click', function(){
                
                pWin_duplicates.dialog('close');

            });

            $("#pWin_duplicates_dups").on('keyup', function(){
                
                var dups = $("#pWin_duplicates_dups").val();

                if(parseInt(dups) > 20)
                {
                    $("#pWin_duplicates_dups").val(20);
                }

            });

            $("#pWin_line_count_btnCancel").on('click', function(){

                pWin_line_count.dialog('close');

            });

            $("#pWin_line_count_btnSave").on('click', function(){

                var line_count = document.getElementById("pWin_line_count_set_to").value;
                set_line_count(line_count);

            });

            $("#pWin_computer_info_btnSetToBroadcast").on('click', function(){

                set_dest_ip("255.255.255.255");

                setTimeout(function(){

                    set_dest_mac("FFFFFFFFFFFF");

                }, 300);

            });

            $("#pWin_computer_info_btnSetToComputer").on('click', function(){

                set_dest_ip($("#pWin_computer_info_com_ip").text());

                setTimeout(function(){

                    var mac = $("#pWin_computer_info_com_mac").text();
                    mac = mac.split(/-/).join("");
                    set_dest_mac(mac);

                }, 300);

            });

            setTimeout(watch_for_status_change, 1000);

        });

    </script>

    </head>
  <body>
      
    <div class="header_row">
        <div class="top_header">
            <table>
                <tr>
                    <td style="width: 180px;">
                        Starting Line Count = <span class="custom_label" id="lbLineCount">01</span>
                    </td>
                    <td style="width: 140px;">
                        # Of Dups: <span class="custom_label" id="lbDups">1</span>
                    </td>
                    <td>
                        <label for="ckbIgnoreDups">
                            <input type="checkbox" id="ckbIgnoreDups" checked="true"/>Ignore Dups
                        </label>
                    </td>
                </tr>
            </table>
            
        </div>
    </div>
    
    <table style="width: 100%;">

        <tr id="not_bound_win" class="hidden">

            <td style="width:330px;padding-bottom:2px;padding-top:15px;padding-left:20px;line-height: 125%;">
                <span style="color:red;font-size: large;font-weight: bold;">A program is blocking ELConfig's connection to the unit.</span>
                <br/><br/><br/>
                
                <div id="win_resmon_step_1" style="padding-bottom: 10px;">
                    Follow the 3 Steps below to Resolve Issue:<br/>
                    <br/>
                    <b>Step One:</b><br/><br/>
                    <button id="btnOpenResourceMon">Open Resource Monitor</button><br/><br/>
                </div>

                <div id="win_resmon_step_2" style="padding-bottom: 10px;" class="hidden">
                    <b>Step Two:</b><br/><br/>
                    Go to "Network" Tab. Then expand "Listening Ports" and look for port <span id="win_resmon_port">nnnn</span>. Refer to the image shown.<br/><br/>
                    <button id="win_resmon_step_2_back">Back</button>
                    <button id="win_resmon_step_2_next" style="margin-right:15px;">Next</button>
                    
                </div>

                <div id="win_resmon_step_3" style="padding-bottom: 10px;" class="hidden">
                    <b>Step Three:</b><br/><br/>
                    Enter PID of the program bound to <span id="win_resmon_port_2">nnnn</span>: <input id="pid" style="width:60px;" maxlength="6"/> <button id="btnKillTask">Close Bound Program</button><br/>
                    <br/>
                    <button id="win_resmon_step_3_back">Back</button>
                </div>
                
            </td>

            <td style="height:230px;">

                <div id="resmon_fades"></div>

            </td>

        </tr>

        <tr id="not_bound_mac" class="hidden">

            <td style="width:330px;padding-bottom:2px;padding-top:2px;padding-left:20px;line-height: 125%;">
                <span style="color:red;font-size: large;font-weight: bold;">A program is blocking ELConfig's connection to the unit.</span>
                <br/><br/>
                <span>Please close any programs using ports 3520 or 6699.</span>
                <br/>                
            </td>

            <td style="height:230px;">

                

            </td>

        </tr>

        <tr id="not_connected" class="hidden">

            <td style="padding-bottom:5px;padding-top:5px;padding-left: 100px;line-height: 125%;">

                <p style="font-weight: bold; padding-bottom: 0px; padding-top: 0px;margin-bottom: 0px; margin-top: 0px;">CallerID.com Device Not Detected</p>
                <p>Facts:</p>
                <ul style="padding-bottom: 0px; padding-top: 4px;margin-bottom: 0px; margin-top: 0px;">
                    <li>Both the Caller ID device and the computer running ELConfig 5 must 
                        be connected to the LAN side of the same router.
                    </li>
                    <li>
                        The Caller ID device is not capable of DHCP (automatic IP 
                        assignment). It can only be set statically.
                    </li>
                    <li>
                        The factory default IP address on the device is 192.168.0.90. 
                        This cannot be reset without connecting to the unit.
                    </li>
                </ul>

                <p>Troubleshooting Steps:</p>
                <ol style="padding-bottom: 0px; padding-top: 4px;margin-bottom: 0px; margin-top: 0px;">
                    <li>
                        If Whozz Calling? Basic model, set all DIP switches to the down position.
                    </li>
                    <li>
                        Un-power the Caller ID device and connect it to the LAN side of the same router 
                        that this computer is connected.  Then, power on the Caller ID device.
                    </li>
                    <li>
                        Use <span id="pingLink" style="text-decoration: underline; font-weight: bold;">Tools/Ping</span> and try pinging the Caller ID device's default  IP address: 192.168.0.90.
                    </li>
                    <li>
                        Connect the device directly to PC or laptop and set IP of unit within IP scheme of subnet.
                    </li>
                </ol>

            </td>

        </tr>
        <tr id="edit_settings">
            <td>
            
                <table class="edit_settings">

                    <tr>
                        <td style="width:200px;">
                            <p align="right"><b>Unit Number: </b></p>
                        </td>
                        <td style="width:100px;">
                            <input type="text" style="width:54px" id="tbUnitNumber" disabled="true" maxlength="6" class="custom_input"/><br/>
                        </td>
                        <td style="width:100px;">
                            <button width="80px" id="btnChangeUnitNumber">Change</button><br/>
                        </td>
                    </tr>
            
                    <tr>
                        <td>
                            <p align="right"><b>Unit IP: </b></p>
                        </td>
                        <td>
                            
                            <div id="tbUnitIP" class="input_ip" disabled="true">

                                <input type="text" maxlength="3" disabled="true" id="tbUnitIP_1"/> .
                                <input type="text" maxlength="3" disabled="true" id="tbUnitIP_2"/> .
                                <input type="text" maxlength="3" disabled="true" id="tbUnitIP_3"/> .
                                <input type="text" maxlength="3" disabled="true" id="tbUnitIP_4"/>
                            
                            </div>

                        </td>
                        <td style="width:165px;">
                            <button id="btnSuggestIP">Set to Suggested IP</button><br/>
                        </td>
                    </tr>
            
                    <tr>
                        <td>
                            <p align="right"><b>Unit MAC Address: </b></p>
                        </td>
                        <td>
                            
                            <div class="input_mac" disabled="true">

                                <input type="text" maxlength="2" disabled="true" id="tbUnitMAC_1"/> -
                                <input type="text" maxlength="2" disabled="true" id="tbUnitMAC_2"/> -
                                <input type="text" maxlength="2" disabled="true" id="tbUnitMAC_3"/> -
                                <input type="text" maxlength="2" disabled="true" id="tbUnitMAC_4"/> -
                                <input type="text" maxlength="2" disabled="true" id="tbUnitMAC_5"/> -
                                <input type="text" maxlength="2" disabled="true" id="tbUnitMAC_6"/>
                            
                            </div>

                        </td>
                    </tr>
            
                    <tr>
                        <td>
                            <p align="right"><b>Destination Port: </b></p>
                        </td>
                        <td>
                            <select id="cbDestPort" disabled="true">
                                <option selected="selected">3520</option>
                                <option>6699</option>
                            </select>
                        </td>
                        <td style="width:100px;">
                            <button width="80px" id="btnChangeDestPort">Change</button><br/>
                        </td>
                    </tr>
            
                    <tr>
                        <td>
                            <p align="right"><b>Destination IP Address: </b></p>
                        </td>
                        <td>
                            
                            <div id="tbDestIP" class="input_ip" disabled="true">

                                <input type="text" disabled="true" maxlength="3" id="tbDestIP_1"/> .
                                <input type="text" disabled="true" maxlength="3" id="tbDestIP_2"/> .
                                <input type="text" disabled="true" maxlength="3" id="tbDestIP_3"/> .
                                <input type="text" disabled="true" maxlength="3" id="tbDestIP_4"/>
                            
                            </div>

                        </td>
                        <td style="width:100px;">
                            <button width="80px" id="btnChangeDestIP">Change</button><br/>
                        </td>
                    </tr>
            
                    <tr>
                        <td>
                            <p align="right"><b>Destination MAC Address: </b></p>
                        </td>
                        <td>
                            
                            <div id="tbDestMAC" class="input_mac" disabled="true">

                                <input type="text" disabled="true" id="tbDestMAC_1"/> -
                                <input type="text" disabled="true" id="tbDestMAC_2"/> -
                                <input type="text" disabled="true" id="tbDestMAC_3"/> -
                                <input type="text" disabled="true" id="tbDestMAC_4"/> -
                                <input type="text" disabled="true" id="tbDestMAC_5"/> -
                                <input type="text" disabled="true" id="tbDestMAC_6"/>
                            
                            </div>

                        </td>
                        <td style="width:100px;">
                            <button width="80px" id="btnChangeDestMAC">Change</button><br/>
                        </td>
                    </tr>

                </table>
                
            </td>

            <td class="info_area">
                <div id="lbInfoTitle" class="custom_label">ELConfig 5:</div>
                <p></p><span id="lbInfoContent">
                    <!-- Content for info area -->
                </span></p>
            </td>
        </tr>

    </table>

    <table style="padding-left: 5px; width: 100%;">

        <tr>

            <td id="comm_data_button" style="width: 300px;">
                Communication Data &nbsp;<input type="button" id="btnClearCommData" value="Clear"/>
                Firmware: <span style="display: inline;" id="lbFirmwareVersion">Unknown</span>
            </td>
            
            <!-- Toggles -->
            <td style="width: 300px"></td>
            <td id="toggle_settings" class="hidden">
                <input type="button" id="btnGetToggles" value="Retrieve Toggles"/>
                <input type="button" id="btnToggleC" value="C"/>
                <input type="button" id="btnToggleU" value="U"/>
                <input type="button" id="btnToggleD" value="D"/>
                <input type="button" id="btnToggleA" value="A"/>
                <input type="button" id="btnToggleS" value="S"/>
                <input type="button" id="btnToggleO" value="O"/>
                <input type="button" id="btnToggleB" value="B"/>
                <input type="button" id="btnToggleK" value="K"/>
            </td>

            <!------------->

        </tr>

    </table>

    <!-- Comm. Gridview -->
    <table id="table_comm" class="grid_background_comm">
        <thead><th class='grid_header'>Unit Output</th></thead>
        <tbody id="gv_comm_data" class="grid_comm">
            <!-- COMM ROWS -->
        </tbody>
    </table>

    <table style="padding-left: 5px; width: 100%;">
        <tr>
            <td>
                Phone Data &nbsp;<input type="button" id="btnClearPhoneData" value="Clear"/>
            </td>
        </tr>
    </table>

    <!-- Phone Gridview -->
    <div class="grid_background_phone">

        <div class="grid_header_phone">
            <table>
                <tr>
                  <td style="width:40px;">Ln</td>
                  <td style="width:46px;">IO</td>
                  <td style="width:42px;">SE</td>
                  <td style="width:62px;">Dur</td>
                  <td style="width:42px;">CS</td>
                  <td style="width:42px;">Rings</td>
                  <td style="width:28px;">Date</td>
                  <td style="width:82px;">Time</td>
                  <td style="width: 192px;">Number</td>
                  <td style="border:none; width: 240px;">Name</td>
                </tr>
            </table>
        </div>
        
        <div id="gv_phone_data" class="grid_phone">
            <!-- PHONE DATA -->
        </div>
      
      </div>

    <!-- Status Bar -->
    <table id="status_bar" class="status_bar_disconnected">
        <tr>
            <td style="padding-left: 20px;">
                
            </td>
            <td>
                <span id="lbStatus">NOT Connected</span>
            </td>
            <td>
                <span id="lbSendingTo">Sending Commands to: 000.000.000.000</span>
            </td>
            <td>
                <span id="lbDeluxeUnit">Deluxe Unit NOT Detected</span>
            </td>
            <td>
                <span id="lbBoundTo">Bound: Failed</span>
            </td>
        </tr>
    </table>

    </body>
</html>

<!-------------------------------------------------------->
<!--                 Popups/Windows                     -->
<!-------------------------------------------------------->
<div id="pWin_ping" title="Ping IP Address" class="hidden">

    <center>
        Ping This IP:
        <div class="input_ip" style="display:inline;margin-right:5px;">

            <input type="text" maxlength="3" id="pWin_ping_1" value="192"/> .
            <input type="text" maxlength="3" id="pWin_ping_2" value="168"/> .
            <input type="text" maxlength="3" id="pWin_ping_3" value="0"/> .
            <input type="text" maxlength="3" id="pWin_ping_4" value="90"/>

        </div>

        <button id="pWin_ping_btnPing">Ping <span class="ui-icon ui-icon-arrowthick-1-e"></span></button>
    </center>

    <div style="margin-top:5px;padding: 10px;background-color: rgb(214, 241, 243);">
        <span id="pWin_ping_ip_return" style="white-space: pre-wrap;">Type IP then click 'Ping'</span>
    </div>

</div>

<div id="pWin_reseting_to_el_defaults" title="Resetting..." class="hidden">

    <p>Resetting to Ethernet Defaults</p>
    <br/>
    <div id="pWin_reseting_to_el_defaults_progressbar"></div>

</div>

<div id="pWin_setting_deluxe_output" title="Setting Deluxe Output Defaults" class="hidden">

    <p>Setting Deluxe Unit Output Defaults</p>
    <br/>
    <div id="pWin_deluxe_output_progressbar"></div>

</div>

<div id="pWin_deluxe_to_basic" title="Setting Deluxe Unit to Basic Settings" class="hidden">

    <p>Setting Deluxe Unit to Basic Settings</p>
    <br/>
    <div id="pWin_deluxe_to_basic_progressbar"></div>

</div>

<div id="pWin_time_change" title="Time changed to PC time" class="hidden">

    <p>Time on Caller ID Unit has been changed to this PC's time.</p>

</div>

<div id="pWin_line_count" title="Set Line Numbers Reported" class="hidden">

    <p>Current Starting Line Number: <span style="font-weight:bold;" id="pWin_line_count_current_count">01</span></p>
    <br/>
    Starting Line Number: 
    <select id="pWin_line_count_set_to">
        <option selected="selected">01</option>
        <option>05</option>
        <option>09</option>
        <option>17</option>
        <option>21</option>
        <option>25</option>
        <option>33</option>
    </select>
    <br/><br/>

    <table>
        <tr>
            <td style="padding-left: 0px;">
                <button id="pWin_line_count_btnCancel">Close</button>
            </td>
            <td style="float:right;">
                <button id="pWin_line_count_btnSave">Save</button>
            </td>
        </tr>
    </table>

</div>

<div id="pWin_duplicates" title="Duplicate Call Records" class="hidden">

    <p>This option sends duplicate packets for each call record.</p>
    <p>Normally used for wireless tablets which routinely ignore UDP broadcast packets when busy with other processes.</p>
    <p>Setting this number to 8 should increase throughput to well above 99%.  Sending more duplicates than necessary may actually decrease throughput.</p>
    <br/><br/>

    <center>
        Number of Packets sent: <input type="number" style="width: 50px;text-align: center;" id="pWin_duplicates_dups" value="8" min="1" max="20"/>

        <br/><br/>
        <p><span style="color:red">
            The Caller ID capture routine within your application must
            be able to ignore duplicate call records received.
        </span></p>
    </center>
    <br/>

    <table>
        <tr>
            <td style="padding-left: 0px;">
                <button id="pWin_duplicates_btnCancel">Close</button>
            </td>
            <td style="float:right;">
                <button id="pWin_duplicates_btnSave">Save</button>
            </td>
        </tr>
    </table>

</div>

<div id="pWin_computer_info" title="Computer IP & MAC Address" class="hidden">

    <center>
        <table>
        
            <tr>
            
                <td style="padding-top:20px;text-align:center;padding-right:40px;">
                
                <b>Computer IP</b><br/>
                <span id="pWin_computer_info_com_ip">0.0.0.0</span><br/>
                <br/>
                <b>Computer MAC</b><br/>
                <span id="pWin_computer_info_com_mac">00-00-00-00-00-00</span>
                
                </td>
                
                <td style="padding-top:5px;">
                
                    <center>
                        <b>Set Destination</b>
                        <br/>
                        <button style="width:150px;margin-bottom:5px;margin-top:10px;" id="pWin_computer_info_btnSetToComputer">Set to this Computer</button>
                        <br/>
                        <button style="width:150px;" id="pWin_computer_info_btnSetToBroadcast">Set to Broadcast</button>
                        <br/><br/>
                        <button id="pWin_computer_info_btnClose">Close</button>
                    </center>
                
                </td>
                
                <td style="padding-top:20px;text-align:center;padding-left:40px;">
                
                <b>Destination IP</b><br/>
                <span id="pWin_computer_info_dest_ip">0.0.0.0</span><br/>
                <br/>
                <b>Destination MAC</b><br/>
                <span id="pWin_computer_info_dest_mac">00-00-00-00-00-00</span>
                
                </td>
            
            </tr>
        
        </table>
    </center>
</div>

<!-------------------------------------------------------->